<!-- app/views/categories/show.html.erb -->
<!-- Feature 2.2 - Navigate through products by category -->
<div class="container-fluid py-5" style="background: linear-gradient(135deg, #fce7f3 0%, #e9d5ff 100%); min-height: 100vh;">
  
  <!-- Breadcrumb -->
  <div class="container">
    <nav aria-label="breadcrumb">
      <ol class="breadcrumb">
        <li class="breadcrumb-item"><%= link_to "Home", root_path %></li>
        <li class="breadcrumb-item"><%= link_to "Categories", root_path %></li>
        <li class="breadcrumb-item active" aria-current="page"><%= @category.category_name %></li>
      </ol>
    </nav>
  </div>

  <!-- Category Header -->
  <div class="container text-center mb-5">
    <h1 class="display-4 fw-bold text-dark mb-3"><%= @category.category_name %></h1>
    
    <% if @category.description.present? %>
      <p class="lead text-muted mb-3" style="max-width: 700px; margin-left: auto; margin-right: auto;">
        <%= @category.description %>
      </p>
    <% end %>
    
    <p class="text-muted fst-italic">
      <%= pluralize(@products.total_count, 'book') %> in this category
    </p>
  </div>

  <!-- Products Grid -->
  <div class="container">
    <% if @products.any? %>
      <div class="row row-cols-1 row-cols-sm-2 row-cols-md-3 row-cols-lg-4 g-4">
        <% @products.each do |product| %>
          <div class="col">
            <div class="card h-100 shadow-sm hover-lift">
              <!-- Product Image -->
              <% if product.cover_image.attached? %>
                <%= link_to product_path(product) do %>
                  <%= image_tag product.cover_image, class: "card-img-top", style: "height: 350px; object-fit: cover;" %>
                <% end %>
              <% else %>
                <%= link_to product_path(product) do %>
                  <div class="bg-gradient text-white d-flex align-items-center justify-content-center" 
                       style="height: 350px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                    <span style="font-size: 5rem;">ðŸ“š</span>
                  </div>
                <% end %>
              <% end %>

              <!-- New Badge -->
              <% if product.created_at > 3.days.ago %>
                <span class="position-absolute top-0 start-0 m-2 badge bg-success fs-6">
                  NEW
                </span>
              <% end %>

              <div class="card-body d-flex flex-column">
                <h5 class="card-title fw-bold" style="min-height: 48px;">
                  <%= link_to product.title, product_path(product), class: "text-decoration-none text-dark" %>
                </h5>
                
                <% if product.authors.any? %>
                  <p class="card-text text-muted fst-italic small mb-2">
                    by <%= product.authors.map(&:author_name).join(', ') %>
                  </p>
                <% end %>

                <!-- Price -->
                <p class="fs-4 fw-bold text-success mb-3">
                  <%= number_to_currency(product.current_price) %>
                </p>

                <!-- View Details Button -->
                <%= link_to "View Details", product_path(product), class: "btn btn-primary w-100 mt-auto fw-semibold" %>
              </div>
            </div>
          </div>
        <% end %>
      </div>

      <!-- Pagination -->
      <div class="mt-5 d-flex justify-content-center">
        <%= paginate @products, theme: 'bootstrap-5' %>
      </div>

    <% else %>
      <!-- Empty Category -->
      <div class="text-center py-5">
        <div class="mb-4">
          <span style="font-size: 6rem;">ðŸ“š</span>
        </div>
        <h2 class="mb-3">No Books Available</h2>
        <p class="text-muted mb-4 fs-5">This category doesn't have any books yet.</p>
        <%= link_to "â† Back to All Products", root_path, class: "btn btn-primary btn-lg" %>
      </div>
    <% end %>
  </div>
</div>

<style>
  .hover-lift {
    transition: transform 0.3s ease, box-shadow 0.3s ease;
  }
  
  .hover-lift:hover {
    transform: translateY(-8px);
    box-shadow: 0 10px 30px rgba(0,0,0,0.2) !important;
  }
  
  .card-title {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
</style>